<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.54">


<title data-react-helmet="true">Use the VDM to consume OData Services | SAP Cloud SDK</title>

<meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Use the VDM to consume OData Services | SAP Cloud SDK"><meta data-react-helmet="true" name="description" content="This article describes how the SAP Cloud SDK for Java can be used to build and run OData requests."><meta data-react-helmet="true" property="og:description" content="This article describes how the SAP Cloud SDK for Java can be used to build and run OData requests."><meta data-react-helmet="true" name="keywords" content="sap,cloud,sdk,odata,java,VDM,generate"><meta data-react-helmet="true" property="og:url" content="https://github.com/SAP/cloud-sdk/cloud-sdk/docs/java/features/odata/use-generated-odata-vdm-v2-v4">

<link data-react-helmet="true" rel="shortcut icon" href="/cloud-sdk/img/favicon.ico">


<link rel="stylesheet" href="/cloud-sdk/styles.f7db5d1d.css">


<link rel="preload" href="/cloud-sdk/styles.8cefa9ef.js" as="script">

<link rel="preload" href="/cloud-sdk/runtime~main.84b46104.js" as="script">

<link rel="preload" href="/cloud-sdk/main.bab8011f.js" as="script">

<link rel="preload" href="/cloud-sdk/1.afaaee86.js" as="script">

<link rel="preload" href="/cloud-sdk/2.f9466d17.js" as="script">

<link rel="preload" href="/cloud-sdk/3.27266d01.js" as="script">

<link rel="preload" href="/cloud-sdk/1be78505.dbe4c01e.js" as="script">

<link rel="preload" href="/cloud-sdk/06bd7c86.0662e187.js" as="script">

<link rel="preload" href="/cloud-sdk/17896441.00dc624f.js" as="script">

<link rel="preload" href="/cloud-sdk/82b55dc1.cadca555.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/cloud-sdk/"><img class="navbar__logo" src="/cloud-sdk/img/logo.svg" alt="SAP Cloud SDK"><strong class="navbar__title">SAP Cloud SDK</strong></a><a class="navbar__item navbar__link" href="/cloud-sdk/docs/overview/about">Docs</a><a target="_blank" rel="noopener noreferrer" href="https://blogs.sap.com/" class="navbar__item navbar__link">Blog</a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a activeclassname="navbar__link--active" class="navbar__item navbar__link">Support</a><ul class="dropdown__menu"><li><a target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/questions/tagged/sap-cloud-sdk" class="dropdown__link">Stack Overflow</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/SAP/cloud-sdk/issues" class="dropdown__link">GitHub JS/TS</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.wdf.sap.corp/MA/sdk" class="dropdown__link"> GitHub Java</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a activeclassname="navbar__link--active" class="navbar__item navbar__link">Release notes</a><ul class="dropdown__menu"><li><a target="_blank" rel="noopener noreferrer" href="https://help.sap.com/doc/6c02295dfa8f47cf9c08a19f2e172901/1.0/en-US/index.html" class="dropdown__link">Java SDK</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://help.sap.com/doc/2324e9c3b28748a4ae2ad08166d77675/1.0/en-US/js-index.html" class="dropdown__link">JS SDK</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/SAP/cloud-s4-sdk-pipeline/releases" class="dropdown__link">CI/CD Toolkit</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a target="_blank" rel="noopener noreferrer" href="https://api.sap.com/" class="navbar__item navbar__link">SAP API Hub</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/SAP/cloud-sdk" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/cloud-sdk/"><img class="navbar__logo" src="/cloud-sdk/img/logo.svg" alt="SAP Cloud SDK"><strong class="navbar__title">SAP Cloud SDK</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" position="left" href="/cloud-sdk/docs/overview/about">Docs</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://blogs.sap.com/" class="menu__link" position="left">Blog</a></li><li class="menu__list-item"><a activeclassname="navbar__link--active" class="menu__link menu__link--sublist" position="left">Support</a><ul class="menu__list"><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/questions/tagged/sap-cloud-sdk" class="menu__link">Stack Overflow</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/SAP/cloud-sdk/issues" class="menu__link">GitHub JS/TS</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://github.wdf.sap.corp/MA/sdk" class="menu__link"> GitHub Java</a></li></ul></li><li class="menu__list-item"><a activeclassname="navbar__link--active" class="menu__link menu__link--sublist" position="left">Release notes</a><ul class="menu__list"><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://help.sap.com/doc/6c02295dfa8f47cf9c08a19f2e172901/1.0/en-US/index.html" class="menu__link">Java SDK</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://help.sap.com/doc/2324e9c3b28748a4ae2ad08166d77675/1.0/en-US/js-index.html" class="menu__link">JS SDK</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/SAP/cloud-s4-sdk-pipeline/releases" class="menu__link">CI/CD Toolkit</a></li></ul></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://api.sap.com/" class="menu__link" position="right">SAP API Hub</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/SAP/cloud-sdk" class="menu__link" position="right">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Dzen</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/dzen/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/dzen/how-to-write-documentation">Documentation How To</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Overview</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/overview/about">About</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/overview/getting-started">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/overview/benefits">Benefits</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Java</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-sdk/docs/java/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-sdk/docs/java/getting-started">Getting started</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Core Features</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">OData</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-sdk/docs/java/features/odata/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-sdk/docs/java/features/odata/java-generate-odata-vmd-v2-v4">Generate a VDM for OData</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" tabindex="0" href="/cloud-sdk/docs/java/features/odata/use-generated-odata-vdm-v2-v4">Consume OData Services</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Connectivity</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/java/features/connectivity/sdk-connectivity-destination-service">Destinations</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">REST</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/java/features/rest/sap-cloud-sdk-as-a-service">SDK as a service</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Released clients</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/java/features/rest/clients/workflow-api">Shiny label :)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/java/features/rest/clients/currency-conversion">Shiny label :)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/java/features/rest/clients/core-services">Shiny label :)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/java/features/rest/clients/blockchain-business-sdk">Shiny label :)</a></li></ul></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/java/guides/sap-cloud-sdk-linux-how-to">SAP Cloud SDK on Linux</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/java/guides/cf-cli">Cloud Foundry CLI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/java/guides/cf-deploy">Deploy to Cloud Foundry</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/cloud-sdk/docs/java/api-reference-java">JavaDoc API Reference</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">JavaScript</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/js/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/js/getting-started">Getting started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/js/api-reference-js-ts">JSDoc API reference</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Continuous Delivery</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/devops/getting-started">Getting started</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Community calls</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/community-calls/community-calls-2020">2020</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Related projects</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/cloud-sdk/docs/related-projects/cloud-application-model">CAP (Cloud Application Model)</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Use the VDM to consume OData Services</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="build-and-execute-odata-requests-with-the-virtual-data-model"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#build-and-execute-odata-requests-with-the-virtual-data-model" title="Direct link to heading">#</a>Build and execute OData Requests with the Virtual Data Model</h1><p>The Virtual Data Model (VDM) allows to build type-safe OData requests for a given service. The java classes represent the <em>data model</em> and the available <em>operations</em> of the service. As a consequence all requests that are build through the VDM are not only <em>syntactically valid</em> but also <em>semantically valid</em>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="using-the-fluent-api"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-the-fluent-api" title="Direct link to heading">#</a>Using the Fluent API</h2><p>The VDM consists of <em>service</em> and <em>data model</em> classes. The service classes mirror the API provided by the OData service and serve as entry point for creating requests. They provide a builder which allows for adding further parameters in a fluent way.</p><p>To execute HTTP requests the OData client leverages <em>Destinations</em> and are documented in more detail <a href="/cloud-sdk/docs/java/features/connectivity/sdk-connectivity-destination-service">here</a>. The following code snippets assume that such a destination is in place:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">HttpDestination destination;</span></div></div></div></div></div><p>On an abstract level requests are generally build up according to the following pattern:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">result = service.operation()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    .withParameter(...)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    .execute(destination);</span></div></div></div></div></div><ul><li><em>operation</em> corresponds to the service&#x27;s capabilities for entities e.g. <code>createEntity</code> or <code>readEntities</code>.</li><li><em>withParameter</em> corresponds to:<ul><li>OData query parameters e.g. <code>filter</code> or <code>orderby</code></li><li>Or other modifiers like custom headers</li></ul></li><li>Which OData parameters are available depends on the operation. For example when updating entities the <code>$filter</code> parameter is not available.</li></ul><p>Below different OData features are documented using the <a href="https://api.sap.com/api/API_BUSINESS_PARTNER/resource">Business Partner Service</a> on S/4HANA as an example. It is represented by the <code>BusinessPartnerService</code> class which is part of the pre-generated S/4HANA VDM. The following code snippets assume that an instance of this service is setup:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">BusinessPartnerService service = new DefaultBusinessPartnerService();</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="odata-features"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#odata-features" title="Direct link to heading">#</a>OData Features</h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="basic-crud-operations"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#basic-crud-operations" title="Direct link to heading">#</a>Basic CRUD Operations</h3><p>Create, Read, Update and Delete operations on entities are build from the associated service class:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">service.createBusinessPartner(partner);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">service.getBusinessPartnerByKey(&quot;id&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">service.getAllBusinessPartner();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">service.updateBusinessPartner(partner);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">service.deleteBusinessPartner(partner);</span></div></div></div></div></div><p>Each of the above statements returns a builder object that allows for specifying certain request parameters, depending on the operation.</p><p>The following query parameters and request options are available for these operations:</p><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="false" class="tab-item tabItem_3zTA">OData V2</li><li role="tab" tabindex="0" aria-selected="true" class="tab-item tabItem_3zTA tab-item--active">OData V4</li></ul><div role="tabpanel" class="margin-vert--md"><div><p>Query parameters:</p><ul><li><code>$select</code>, <code>$expand</code> and <code>$search</code> are available on reading a single or multiple entities</li><li><code>$filter</code>, <code>$top</code>, <code>$skip</code> and <code>$orderby</code> are available only when reading a collection of entities</li></ul><p>Request parameters:</p><ul><li>Update operations allow to set either <code>modifyingEntity()</code> or <code>replacingEntity()</code> which will result in <code>HTTP PATCH</code> or <code>HTTP PUT</code> respectively. By default entities are modified via <code>PATCH</code>.</li><li>Update and delete operations allow to modify how ETags are handled:<ul><li>By default an ETag is send if one is present on the entity being modified.</li><li><code>matchAnyVersionIdentifier()</code> will instead always send a <code>*</code> which acts as a wildcard to match all ETags.</li><li><code>ignoreAnyVersionIdentifier()</code> will ensure that no ETag is sent.</li></ul></li><li>All operations allow for adding custom headers via <code>withheader(...)</code></li></ul></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="handling-of-etags"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#handling-of-etags" title="Direct link to heading">#</a>Handling of ETags</h4><p>An <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/ETag">ETag</a> is a version identifier which is often used to implement an optimistic locking mechanism. The SDK will try to read version identifiers from responses and set them when sending OData requests.</p><p>Consider the following example:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">partner = service.getBusinessPartnerByKey(&quot;id&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 .execute(destination);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">service.updateBusinessPartner(partner)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                 .execute(destination);</span></div></div></div></div></div><p>On the read request the SDK will automatically try to extract the version identifier from the response and store it within the <code>partner</code> object. When updating it will be taken from there and sent with the <code>If-match</code> header.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>If a service requires this header to be sent: Fetching the entity from the service first is essential to ensure that the ETag is present and up to date.</p></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="handling-of-csrf-tokens"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#handling-of-csrf-tokens" title="Direct link to heading">#</a>Handling of CSRF tokens</h4><p>For create, update and delete requests the SDK will try to send a <a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery#Cookie-to-header_token">CSRF token</a>. Upon execution the request will try to fetch a token first before issuing the actual create request. Many services require this behavior for security reasons. However, the create request will be made without a CSRF token if none could be obtained.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="select"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#select" title="Direct link to heading">#</a>Select</h3><p>When reading entities the API offers <code>select( ... )</code> on the builders. Through it the query parameters <code>$select</code> and <code>$expand</code> are set. It takes in properties of the entity being queried. Primitive properties are added to <code>$select</code> while complex and navigational properties are added to <code>$expand</code>. This handling is done automatically by the SDK.</p><p>The properties that can be selected or expanded are represented via static <em>fields on the entity</em> class. So there will be a field for each property. E.g. for the business partner entity one can find <code>BusinessPartner.FIRST_NAME</code> and <code>BusinessPartner.LAST_NAME</code>.</p><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="false" class="tab-item tabItem_3zTA">OData V2</li><li role="tab" tabindex="0" aria-selected="true" class="tab-item tabItem_3zTA tab-item--active">OData V4</li></ul><div role="tabpanel" class="margin-vert--md"><div><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">service.getBusinessPartnerByKey(&quot;id&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    .select(BusinessPartner.FIRST_NAME, BusinessPartner.LAST_NAME, BusinessPartner.TO_BUSINESS_PARTNER_ADDRESS)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    .execute(destination);</span></div></div></div></div></div><p>The above translates to the following query parameters:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$select=FirstName,LastName&amp;$expand=to_BusinessPartnerAddress</span></div></div></div></div></div><p>OData v4 allows for formulating nested, fully featured queries on complex and navigational properties. Querying nested objects is possible within expand. That means the following query is possible:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">service.getBusinessPartnerByKey(&quot;id&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    .select(BusinessPartner.TO_BUSINESS_PARTNER_ADDRESS</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        .select(BusinessPartnerAddress.CITY_CODE, BusinessPartnerAddress.COUNTRY)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        .filter(BusinessPartnerAddress.CITY_CODE.notEqualTo(&quot;1234&quot;))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        .orderBy(BusinessPartnerAddress.COUNTRY.desc())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    .execute(destination);</span></div></div></div></div></div><p>The above translates to the following <code>expand</code> query parameter:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$expand=to_BusinessPartnerAddress($select=CityCode,Country;$filter=CityCode eq &#x27;1234&#x27;;$orderby=Country desc)</span></div></div></div></div></div></div></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="filter"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#filter" title="Direct link to heading">#</a>Filter</h3><p>When operating on a collection of entities the API offers <code>filter( ... )</code> on the builders. It directly corresponds to the <code>$filter</code> parameter of the request. Filters are also build via the static property fields on entities.</p><p>The following example:</p><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="false" class="tab-item tabItem_3zTA">OData V2</li><li role="tab" tabindex="0" aria-selected="true" class="tab-item tabItem_3zTA tab-item--active">OData V4</li></ul><div role="tabpanel" class="margin-vert--md"><div><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/*</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Get all business partners that either:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  - Have first name &#x27;Alice&#x27; but not last name &#x27;Bob&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  - Or have first name &#x27;Mallory&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">*/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">service.getAllBusinessPartner()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    .filter(BusinessPartner.FIRST_NAME.equalTo(&quot;Alice&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        .and(BusinessPartner.LAST_NAME.notEqualTo(&quot;Bob&quot;))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        .or(BusinessPartner.FIRST_NAME.equalTo(&quot;Mallory&quot;))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    .execute(destination);</span></div></div></div></div></div></div></div></div><p>Will translate to this filter parameter:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$filter=(((FirstName eq &#x27;Alice&#x27;) and (LastName ne &#x27;Bob&#x27;)) or (FirstName eq &#x27;Mallory&#x27;))</span></div></div></div></div></div><p>Take note of the order of <code>and</code> and <code>or</code>. As <code>or</code> is invoked on the result of <code>and</code> it will form the outer expression while <code>and</code> is an inner expression in the first branch of <code>or</code>.</p><p>To achieve a different order with <code>and</code> as the top level statement one would nest the <code>or</code> within <code>and(...)</code>:</p><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="false" class="tab-item tabItem_3zTA">OData V2</li><li role="tab" tabindex="0" aria-selected="true" class="tab-item tabItem_3zTA tab-item--active">OData V4</li></ul><div role="tabpanel" class="margin-vert--md"><div><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">.and(BusinessPartner.LAST_NAME.notEqualTo(&quot;Bob&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    .or(BusinessPartner.FIRST_NAME.equalTo(&quot;Mallory&quot;))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">)</span></div></div></div></div></div></div></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="available-filter-expressions"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#available-filter-expressions" title="Direct link to heading">#</a>Available Filter Expressions</h4><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="false" class="tab-item tabItem_3zTA">OData V2</li><li role="tab" tabindex="0" aria-selected="true" class="tab-item tabItem_3zTA tab-item--active">OData V4</li></ul><div role="tabpanel" class="margin-vert--md"><div><p>The <a href="http://docs.oasis-open.org/odata/odata/v4.01/odata-v4.01-part1-protocol.html#sec_SystemQueryOptionfilter">OData v4 standard</a> allows for a wide range of filter expressions. A detailed list of what is available in the SDK can be obtained from <a href="https://help.sap.com/doc/b579bf8578954412aea2b458e8452201/1.0/en-US/com/sap/cloud/sdk/datamodel/odatav4/expression/package-summary.html">the Javadoc</a>. The functionality can also be discovered through the fluent API.</p><p>The below example leverages OData v4 exclusive features to build a more complex request:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/*</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Fetch all business partners where:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- the last name is at least twice as long as the first name </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- AND the combined string of first and last name does not contain &#x27;bob&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">*/</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">service.getAllBusinessPartner()</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    .filter(BusinessPartner.FIRST_NAME.length().multiply(2).lessThan(BusinessPartner.LAST_NAME.length())</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        .and(BusinessPartner.FIRST_NAME.concat(BusinessPartner.LAST_NAME).contains(&quot;bob&quot;))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    .execute(destination);</span></div></div></div></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="error-handling"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#error-handling" title="Direct link to heading">#</a>Error Handling</h2><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="false" class="tab-item tabItem_3zTA">OData V2</li><li role="tab" tabindex="0" aria-selected="true" class="tab-item tabItem_3zTA tab-item--active">OData V4</li></ul><div role="tabpanel" class="margin-vert--md"><div><p>Sometimes requests fail and the SDK provides a flexible way to deal with such failures on multiple levels. All <code>execute</code> methods may throw a runtime exception (extending) <code>ODataException</code>. This will always contain the request which was (attempted to be) sent out as well as the cause of the exception. To handle all kind of failures consider the following code:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">try { ... }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> catch( final ODataException e ) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ODataQueryGeneric query = e.getQuery();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    logger.debug(&quot;The following query failed: {}&quot;, query);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // do something else</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><p>This handling is the most generic, handling all possible failures. For more specific information there are dedicated exceptions inheriting from <code>ODataException</code>. Please tend to the <a href="https://help.sap.com/doc/b579bf8578954412aea2b458e8452201/1.0/en-US/com/sap/cloud/sdk/datamodel/odatav4/exception/ODataException.html">documentation</a> for all the exception types.</p><p>In order to handle different kinds of failure one can list multiple catch clauses to cover different levels or cases that might occur, e.g.:</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-java codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">try { ... }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">catch( ODataErrorResponseException e ) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">} catch( ODataRequestException e ) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">} catch( ODataDeserializationException e ) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // ...</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div></div></div><p>Note that instead of applying <code>try/catch</code> one can also make use of <code>tryExecute</code> on the request builders.</p></div></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"></div><div class="col text--right"><em><small>Last updated on <time datetime="2020-05-06T15:19:53.000Z" class="docLastUpdatedAt_1sqk">5/6/2020</time> by <strong>Matthias Kuhr</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/cloud-sdk/docs/java/features/odata/java-generate-odata-vmd-v2-v4"><div class="pagination-nav__link--sublabel">Previous</div><div class="pagination-nav__link--label">« OData VDM Generator for Java</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/cloud-sdk/docs/java/features/connectivity/sdk-connectivity-destination-service"><div class="pagination-nav__link--sublabel">Next</div><div class="pagination-nav__link--label">Use destinations to connect to other systems and services »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#using-the-fluent-api" class="contents__link">Using the Fluent API</a></li><li><a href="#odata-features" class="contents__link">OData Features</a><ul><li><a href="#basic-crud-operations" class="contents__link">Basic CRUD Operations</a></li><li><a href="#select" class="contents__link">Select</a></li><li><a href="#filter" class="contents__link">Filter</a></li></ul></li><li><a href="#error-handling" class="contents__link">Error Handling</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/cloud-sdk/docs/overview/about">SAP Cloud SDK overview</a></li><li class="footer__item"><a class="footer__link-item" href="/cloud-sdk/docs/java/getting-started">Cloud SDK for Java</a></li><li class="footer__item"><a class="footer__link-item" href="/cloud-sdk/docs/js/getting-started">Cloud SDK for JS</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="docs/devops/getting-started">Cloud SDK for CI/CD</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://developers.sap.com/tutorial-navigator.html?tag=products:technology-platform/sap-cloud-sdk/sap-cloud-sdk">Cloud SDK Tutorials</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://stackoverflow.com/questions/tagged/sap-cloud-sdk">Stack Overflow</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://developers.sap.com/topics/cloud-sdk.html">SAP Developers Portal</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://community.sap.com/topics/cloud-sdk">Cloud SDK Community Page</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://help.sap.com/viewer/product/SAP_CLOUD_SDK/1.0/en-US?task=discover_task">Cloud SDK on SAP Help</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://https://blogs.sap.com/">Blog</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/SAP/cloud-sdk">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 SAP SE or an SAP affiliate company. All rights reserved.</div></div></div></footer>
</div>

<script src="/cloud-sdk/styles.8cefa9ef.js"></script>

<script src="/cloud-sdk/runtime~main.84b46104.js"></script>

<script src="/cloud-sdk/main.bab8011f.js"></script>

<script src="/cloud-sdk/1.afaaee86.js"></script>

<script src="/cloud-sdk/2.f9466d17.js"></script>

<script src="/cloud-sdk/3.27266d01.js"></script>

<script src="/cloud-sdk/1be78505.dbe4c01e.js"></script>

<script src="/cloud-sdk/06bd7c86.0662e187.js"></script>

<script src="/cloud-sdk/17896441.00dc624f.js"></script>

<script src="/cloud-sdk/82b55dc1.cadca555.js"></script>


</body>
</html>